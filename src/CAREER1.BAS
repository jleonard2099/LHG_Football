'$INCLUDE: 'KeyInput.BI'
'$INCLUDE: 'QPProEqu.BI'

DEFINT A-Z

DIM Z2(50, 18), A1$(50), A2$(40), A3$(20), A4$(15), A5$(15), A6$(10), A7$(10)
DIM A1C$(50), A2C$(40), A3C$(20), A4C$(15), A5C$(15), A6C$(10), A7C$(10)
DIM DIC$(55), DSC$(55)
DIM Z(38), Z1(38),VV$(500),V%(500),PA%(2),Q$(500)
DIM LR(50), LR$(50, 1), LC(60), LC$(60, 1), LP(20), LP$(20, 1), LK(15), LK$(15, 1), PK(15)
DIM PK$(15, 1), DI$(55), GIS(15, 55, 3), DS$(55), GSS(15, 55, 3), GS%(55, 1), GI%(55, 2)
DIM LF$(1), LI(9), LI$(9, 1), item$(7)
DIM AF(1, 4), AM(1, 4), LF(1), D$(1)
DIM Y AS LONG
DIM RBBC(9) AS SINGLE, RBC$(9), RBYR(9)
DIM RBR$(1), WRRC(4) AS SINGLE, WRC$(4), WRYR(4), QBBC(8) AS SINGLE, QBC$(8)
DIM QBYR(8), KRRC(4) AS SINGLE, KRC$(4)
DIM KRYR(4), PRRC(4) AS SINGLE, PRC$(4), PRYR(4), PUUC(2) AS SINGLE, PUC$(2)
DIM PUYR(2), FGGC(6) AS SINGLE, FGC$(6)
DIM FGYR(6), DFFC(1) AS SINGLE, DFC$(1), DFYR(1), PP(15, 20) AS SINGLE
DIM FF(15, 20) AS SINGLE, II(15, 20) AS SINGLE, YY(15, 20) AS SINGLE
DIM RBS$(15, 50, 1)
DIM WRS$(15, 40, 1)
DIM QBS$(15, 20, 1)
DIM KRRS$(15, 15, 1), PRRS$(15, 15, 1)
REDIM PUS(15, 10, 4), FGS(15, 10, 17)
REDIM RBBS(15, 50, 10) AS SINGLE, WRRS(15, 40, 6)  AS SINGLE
REDIM QBBS(15, 20, 12) AS SINGLE, PRS(15, 15, 6)  AS SINGLE, KRS(15, 15, 6) AS SINGLE

1  CLS
	TMR=12840:NB=-1:NC=-1:ND=-1:NE=-1:NF=-1:NG=-1:NH=-1:NI=-1:NJ=0:NK=0:D=0:JX=0:VV=0

OPEN "DEV.BAS" FOR INPUT AS #1:FOR I = 0 TO 1:INPUT #1, D$(I):NEXT:CLOSE #1

	COLOR , 2: LOCATE 1, 1: PRINT TAB(80); : LOCATE , 26: COLOR 0
	PRINT "3 IN 1 FOOTBALL UTILITIES"
	LOCATE 24, 1: PRINT TAB(80); : LOCATE , 1
	PRINT "(C) LANCE HAFFNER/SHANNON LYNN 1991"; TAB(70); LEFT$(TIME$, 5);
	LOCATE 4, 1: COLOR 2, 0
	item$(1) = "MERGE / UPDATE CAREER FILES       "
	item$(2) = "EXIT TO MAIN MENU                 "
	  SELECTION% = 1
	Count% = 2
	Start% = 1
	SCANCODE% = 2
	FileFGColr% = 15:FileBGColr% = 1
	HiLiteFGColr% = 0:HiLiteBGColr% = 7
	Spacing% = 1
	Row% = 8
	Column% = 25

CALL box0(7, 24, 10, 59, 2, 31)	
_MouseShow "DEFAULT"
MMenuVert VARPTR(item$(1)), SELECTION%, Start%, SCANCODE%, FileFGColr%, FileBGColr%, HiLiteFGColr%, HiLiteBGColr%, Count%, Row%, Column%
_MouseHide

	COLOR , 0
	RN = SELECTION%
	IF SCANCODE% = 27 THEN RN = 2
	IF RN = 1 THEN 10
	  RUN "CAREER.EXE"

10   COLOR 14,0:CLS:LOCATE 5,27:PRINT "- - - C A U T I O N - - -"
	COLOR 15:LOCATE 8,8:PRINT"THIS OPTION SHOULD ONLY BE USED WHEN ADDING YEARS TO AN EXISTING STAT"
	PRINT "FILE.  IF YOU ARE CREATING A NEW CAREER FILE, USE OPTION #1.  IF YOU ARE ADDING"
	PRINT "AN ADDITIONAL CAREER YEAR, MAKE SURE THAT ANY UNUSED PLAYER SLOTS (XXX, END,"
	PRINT "ETC.) ARE AT THE END OF THE SEASON STAT LIST BEFORE YOU MERGE."
	LOCATE ,8:PRINT "ALSO MAKE SURE THAT THE PLAYERS NAMES IN THE FILE YOU ARE ADDING, MATCH"
	PRINT "THE EXACT SPELLING OF THE NAME OF THE SAME PLAYER IN THE CAREER FILE FOR THE"
	PRINT "PLAYERS THAT HAD PLAYED IN PREVIOUS YEARS.  EXAMPLE - IF DARREN NELSON IS"
	PRINT "LISTED AS 'NELSON' IN THE CAREER FILE AND THE SEASON STATS HAD HIM AS"
	PRINT "'D.NELSON', HE SHOULD BE CHANGED TO 'NELSON' IN THE SEASON FILE BEFORE"
	PRINT "MERGING, OR YOU COULD CHANGE HIM TO 'D.NELSON' IN THE CAREER FILE"
	PRINT:PRINT
	COLOR 12:LOCATE ,25:PRINT "DO YOU WISH TO CONTINUE? (Y/N)"

2018 I$=GetKeyPress$
	IF UCASE$(I$)="Y" THEN 1150
	RUN "CAREER.EXE"

900 CLS:COLOR 7:PRINT "UNABLE TO LOCATE STAT FILE"
	PRINT:PRINT"HIT ANY KEY TO CONTINUE"

902 I$=GetKeyPress$
	GOTO 1

1150 CLS:FOR J = 15 TO 18: LOCATE J: PRINT STRING$ (68," ")
	NEXT
	GOSUB 4000
	GOSUB 3056
	B$ = A$: GOSUB 6585
	Z1$ = MID$(B$, 4, QQ) + "." + LEFT$(B$, 2)
	CLS:LOCATE 8, 25: INPUT "ENTER YEAR TO ADD (EX. - 1961)"; Y
	LOCATE 9, 25: PRINT "ANY CHANGE (YN)"

60   I$=GetKeyPress$
	IF UCASE$(I$) = "Y" THEN 1150
	VV = 0: LOCATE , 5: PRINT "IS THIS THE FINAL UPDATE FOR THE CURRENT SEASON? (Y/N)"

76   I$=GetKeyPress$
	IF UCASE$(I$) = "Y" THEN JX = 1
	IF UCASE$(I$) = "N" THEN JX = 0
	  LOCATE 20,20:COLOR 15:PRINT"MERGING CAREER STATS . . . . PLEASE WAIT"
	IF NOT _FILEEXISTS(D$(1) + Z$ + ".CAR") THEN 900
OPEN D$(1) + Z$ + ".CAR" FOR INPUT AS #1
	INPUT #1, TN$, NB,NC,ND,NE,NF,NG,NH,NI,NJ,NK
	FOR I=0 TO 49:INPUT #1, A1C$(I):NEXT
	FOR I=0 TO 39:INPUT #1, A2C$(I):NEXT
	FOR I=0 TO 19:INPUT #1, A3C$(I):NEXT
	FOR I=0 TO 14:INPUT #1, A4C$(I):NEXT
	FOR I = 0 TO 14:INPUT #1, A5C$(I):NEXT
	FOR I = 0 TO 9:INPUT #1, A6C$(I):NEXT
	FOR I = 0 TO 9:INPUT #1, A7C$(I):NEXT
	FOR I = 0 TO 54:INPUT #1, DIC$(I):NEXT
	FOR I = 0 TO 54:INPUT #1, DSC$(I):NEXT
	FOR N = 1 TO 15:FOR J = 0 TO 49:FOR K = 0 TO 9
	INPUT #1, RBBS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 49:INPUT #1, RBS$(N,J,0),RBS$(N,J,1):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 39:FOR K = 0 TO 5:INPUT #1, WRRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 39:INPUT #1, WRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 19:FOR K = 0 TO 7:INPUT #1, QBBS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 19:INPUT #1, QBS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:FOR K = 0 TO 5:INPUT #1, KRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:INPUT #1, KRRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:FOR K = 0 TO 5:INPUT #1, PRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:INPUT #1, PRRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 9:FOR K = 0 TO 3:INPUT #1, PUS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 9:FOR K = 0 TO 16:INPUT #1, FGS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 54:FOR K = 0 TO 2:INPUT #1, GIS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 54:FOR K = 0 TO 2:INPUT #1, GSS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
CLOSE #1
	  IF NOT _FILEEXISTS(D$(1) + Z1$) THEN 900
OPEN D$(1) + Z1$ + "S" FOR INPUT AS #1
	INPUT #1, GAMES
CLOSE 1
OPEN D$(1) + Z1$ FOR INPUT AS #1
	INPUT #1, A$
	FOR I = 0 TO 9: INPUT #1, A1$(I): NEXT I
	FOR I = 0 TO 5: INPUT #1, A2$(I): NEXT I
	FOR I = 0 TO 3: INPUT #1, A3$(I): NEXT I
	FOR I = 0 TO 2: INPUT #1, A4$(I): NEXT I
	FOR I = 0 TO 2: INPUT #1, A5$(I): NEXT I
	INPUT #1, A6$(0)
	FOR I = 0 TO 1: INPUT #1, A7$(I): NEXT I
	FOR J = 0 TO 13
	FOR K = 0 TO 17: INPUT #1, Z2(J, K): NEXT K
	NEXT J
	FOR L = 0 TO 38: INPUT #1, Z(L): NEXT L
	FOR L = 0 TO 38: INPUT #1, Z1(L): NEXT L
	FOR J = 0 TO 9: INPUT #1, DI$(J): FOR J1 = 0 TO 2: INPUT #1, GI%(J, J1): NEXT: NEXT
	FOR J = 0 TO 14: INPUT #1, DS$(J): FOR J1 = 0 TO 1: INPUT #1, GS%(J, J1): NEXT: NEXT
	FOR I = 0 TO 9: INPUT #1, LR(I): INPUT #1, LR$(I, 0): INPUT #1, LR$(I, 1): NEXT
	FOR I = 0 TO 15: INPUT #1, LC(I): INPUT #1, LC$(I, 0): INPUT #1, LC$(I, 1): NEXT
	FOR I = 0 TO 3: INPUT #1, LP(I): INPUT #1, LP$(I, 0): INPUT #1, LP$(I, 1): NEXT
	FOR I = 0 TO 2: INPUT #1, LK(I): INPUT #1, LK$(I, 0): INPUT #1, LK$(I, 1): NEXT
	FOR I = 0 TO 2: INPUT #1, PK(I): INPUT #1, PK$(I, 0): INPUT #1, PK$(I, 1): NEXT
	FOR I = 0 TO 1: INPUT #1, LF(I): INPUT #1, LF$(I): FOR I1 = 0 TO 4: INPUT #1, AM(I, I1): INPUT #1, AF(I, I1): NEXT: NEXT
	FOR I = 0 TO 9: INPUT #1, LI(I): INPUT #1, LI$(I, 0): INPUT #1, LI$(I, 1): NEXT
CLOSE #1
	  FOR I=0 TO 9:T%=LEN(A1$(I))
	IF T%=0 THEN A1$(I)="XXX"
	NEXT
	FOR I = 0 TO 5:T%=LEN(A2$(I))
	IF T%=0 THEN A2$(I)="XXX"
	NEXT
	FOR I = 0 TO 3:T%=LEN(A3$(I))
	IF T%=0 THEN A3$(I)="XXX"
	NEXT
	FOR I = 0 TO 2:T%=LEN(A4$(I))
	IF T%=0 THEN A4$(I)="XXX"
	NEXT
	FOR I = 0 TO 2:T%=LEN(A5$(I))
	IF T%=0 THEN A5$(I)="XXX"
	NEXT
	FOR I = 0 TO 1:T%=LEN(A7$(I))
	IF T%=0 THEN A7$(I)="XXX"
	NEXT
	FOR I = 0 TO 9:T%=LEN(DI$(I))
	IF T%=0 THEN DI$(I)="XXX"
	NEXT
	FOR I = 0 TO 14:T%=LEN(DS$(I))
	IF T%=0 THEN DS$(I)="XXX"
	NEXT
	FOR I=0 TO 9
	RR=0:CHK=0
	FOR J=0 TO 49
	IF A1$(I)<>A1C$(J) THEN 1423
	FOR W=1 TO 15:IF RBBS(W,J,8)<>Y THEN 1413
	CHK=CHK+1

1413 NEXT W
	N = 0
	FOR W = 1 TO 15
	N = N + RBBS(W, J, 7)
	NEXT
	IF CHK = 0 THEN N = N + 1
	FOR K = 0 TO 5
	RBBS(N, J, K)=Z2(I,K)
	NEXT K
	RBBS(N,J,6)=LR(I):RBS$(N,J,0)=LR$(I, 0)
	RBBS(N,J,9)=LC(I):RBS$(N,J,1)=LC$(I, 0)
	RBBS(N,J,7)=1:RBBS(N,J,8)=Y
	GOTO 1430

1423 RR=RR+1
	IF RR=50 THEN GOSUB 1450
	NEXT J

1430 NEXT I
	GOTO 1460

1450 IF A1$(I)="END" OR A1$(I)="XXX" OR LEFT$(A1$(I),1)=" " THEN 1456
	NB=NB+1
	A1C$(NB)=A1$(I)
	N=1
	FOR K=0 TO 5:RBBS(N,NB,K)=Z2(I,K):NEXT
	RBBS(N,NB,6)=LR(I):RBS$(N,NB,0)=LR$(I, 0)
	RBBS(N,NB,9)=LC(I):RBS$(N,NB,1)=LC$(I, 0)
	RBBS(N,NB,7)=1:RBBS(N,NB,8)=Y

1456 RETURN

1460 FOR I = 0 TO 5
	RR=0:CHK=0
	FOR J = 0 TO 39
	IF A2$(I)<>A2C$(J) THEN 1473

1464 FOR W= 1 TO 15
	IF WRRS(W,J,5) <> Y THEN 1466

1465 CHK=CHK+1

1466 NEXT W
	N = 0
	FOR W = 1 TO 15
	N = N + WRRS(W, J, 4)
	NEXT
	IF CHK = 0 THEN N = N + 1
	FOR K=6 TO 8
	WRRS(N, J, K-6) = Z2(I,K)
	NEXT K
	WRRS(N,J,3)=LC(I+10):WRS$(N,J,0)=LC$(I+10, 0)
	WRRS(N,J,4)=1:WRRS(N,J,5)=Y
	GOTO 1476

1473 RR=RR+1
	IF RR=40 THEN GOSUB 1478
	NEXT J

1476 NEXT I
	GOTO 1490

1478 IF A2$(I)="END" OR A2$(I)="XXX" OR LEFT$(A2$(I),1)=" " THEN 1484 ELSE 1479

1479 NC=NC+1
	A2C$(NC)=A2$(I)
	N=1
	FOR K = 6 TO 8:WRRS(N,NC,K-6)=Z2(I,K):NEXT
	WRRS(N,NC,3)=LC(I+10):WRS$(N,NC,0)=LC$(I+10, 0)
	WRRS(N,NC,4)=1:WRRS(N,NC,5)=Y

1484 RETURN

1490 FOR I = 0 TO 3
	RR=0:CHK=0
	FOR J = 0 TO 19
	IF A3$(I)<> A3C$(J) THEN 1503

1494 FOR W= 1 TO 15:IF QBBS(W,J,7) <> Y THEN 1496

1495 CHK=CHK+1

1496 NEXT W
	N = 0
	FOR W = 1 TO 15
	N = N + QBBS(W, J, 6)
	NEXT
	IF CHK = 0 THEN N = N + 1
	FOR K=9 TO 13
	QBBS(N, J, K-9) = Z2(I,K)
	NEXT K
	QBBS(N,J,5)=LP(I):QBS$(N,J,0)=LP$(I, 0)
	QBBS(N,J,6)=1:QBBS(N,J,7)=Y
	GOTO 1506

1503 RR=RR+1
	IF RR=20 THEN GOSUB 1508
	NEXT J

1506 NEXT I
	GOTO 1520

1508 IF A3$(I)="END" OR A3$(I)="XXX" OR LEFT$(A3$(I),1)=" " THEN 1514

1509 ND=ND+1
	A3C$(ND)=A3$(I)
	N=1
	FOR K = 9 TO 13:QBBS(N,ND,K-9)=Z2(I,K):NEXT
	QBBS(N,ND,5)=LP(I):QBS$(N,ND,0)=LP$(I, 0)
	QBBS(N,ND,6)=1:QBBS(N,ND,7)=Y

1514 RETURN

1520 FOR I = 0 TO 2
	RR=0:CHK=0
	FOR J = 0 TO 14
	IF A4$(I)<>A4C$(J) THEN 1533

1524 FOR W= 1 TO 15:IF KRS(W,J,5) <> Y THEN 1526

1525 CHK=CHK+1

1526 NEXT W
	N = 0
	FOR W = 1 TO 15
	N = N + KRS(W, J, 4)
	NEXT
	IF CHK = 0 THEN N = N + 1
	FOR K = 14 TO 16
	KRS(N, J, K-14) = Z2(I,K)
	NEXT K
	KRS(N,J,3)=LK(I):KRRS$(N,J,0)=LK$(I, 0)
	KRS(N,J,4)=1:KRS(N,J,5)=Y
	GOTO 1536

1533 RR=RR+1
	IF RR=15 THEN GOSUB 1538
	NEXT J

1536 NEXT I
	GOTO 1550

1538 IF A4$(I)="END" OR A4$(I)="XXX" OR LEFT$(A4$(I),1)=" " THEN 1544

1539 NE=NE+1
	A4C$(NE)=A4$(I)
	N=1
	FOR K = 14 TO 16:KRS(N,NE,K-14)=Z2(I,K):NEXT
	KRS(N,NE,3)=LK(I):KRRS$(N,NE,0)=LK$(I, 0)
	KRS(N,NE,4)=1:KRS(N,NE,5)=Y

1544 RETURN

1550 FOR I = 0 TO 2
	RR=0:CHK=0
	FOR J = 0 TO 14
	IF A5$(I)=A5C$(J) THEN 1554 ELSE 1563

1554 FOR W= 1 TO 15:IF PRS(W,J,5) <> Y THEN 1556

1555 CHK=CHK+1

1556 NEXT W
	N = 0
	FOR W = 1 TO 15
	N = N + PRS(W, J, 4)
	NEXT
	IF CHK = 0 THEN N = N + 1
	FOR K = 14 TO 16
	PRS(N, J, K-14) = Z2(I+3,K)
	NEXT K
	PRS(N,J,3)=PK(I):PRRS$(N,J,0)=PK$(I, 0)
	PRS(N,J,4)=1:PRS(N,J,5)=Y
	GOTO 1566

1563 RR=RR+1
	IF RR=15 THEN GOSUB 1568
	NEXT J

1566 NEXT I
	GOTO 1580

1568 IF A5$(I)="END" OR A5$(I)="XXX" OR LEFT$(A5$(I),1)=" " THEN 1574

1569 NF=NF+1
	A5C$(NF)=A5$(I)
	N=1
	FOR K = 14 TO 16:PRS(N,NF,K-14)=Z2(I+3,K):NEXT
	PRS(N,NF,3)=PK(I):PRRS$(N,NF,0)=PK$(I, 0)
	PRS(N,NF,4)=1:PRS(N,NF,5)=Y

1574 RETURN

1580 FOR I = 0 TO 0
	RR=0:CHK=0
	FOR J = 0 TO 9
	IF A6$(I)<>A6C$(J) THEN 1593

1584 FOR W= 1 TO 15:IF PUS(W,J,3) <> Y THEN 1586

1585 CHK=CHK+1

1586 NEXT W
	IF CHK > 0 THEN 1588 ELSE 1589

1588 N=PUS(1,J,2)+PUS(2,J,2)+PUS(3,J,2)+PUS(4,J,2)+PUS(5,J,2)+PUS(6,J,2)+PUS(7,J,2)+PUS(8,J,2)+PUS(9,J,2)+PUS(10,J,2)+PUS(11,J,2)+PUS(12,J,2)+PUS(13,J,2)+PUS(14,J,2)+PUS(15,J,2):GOTO 1590

1589 N=PUS(1,J,2)+PUS(2,J,2)+PUS(3,J,2)+PUS(4,J,2)+PUS(5,J,2)+PUS(6,J,2)+PUS(7,J,2)+PUS(8,J,2)+PUS(9,J,2)+PUS(10,J,2)+PUS(11,J,2)+PUS(12,J,2)+PUS(13,J,2)+PUS(14,J,2)+PUS(15,J,2)+1

1590 PUS(N,J,0)=Z(7):PUS(N,J,1)=Z(8)
	PUS(N,J,2)=1:PUS(N,J,3)=Y
	GOTO 1596

1593 RR=RR+1
	IF RR=10 THEN GOSUB 1598
	NEXT J

1596 NEXT I
	GOTO 1610

1598 IF A6$(I)="END" OR A6$(I)="XXX" OR LEFT$(A6$(I),1)=" " THEN 1604

1599 NG=NG+1
	A6C$(NG)=A6$(I)
	N=1
	PUS(N,NG,0)=Z(7):PUS(N,NG,1)=Z(8)
	PUS(N,NG,2)=1:PUS(N,NG,3)=Y

1604 RETURN

1610 FOR I = 0 TO 1
	RR=0:CHK=0
	FOR J = 0 TO 9
	IF A7$(I)=A7C$(J) THEN 1614 ELSE 1633

1614 FOR W= 1 TO 15:IF FGS(W,J,16) = Y THEN 1615 ELSE 1616

1615 CHK=CHK+1

1616 NEXT W
	IF CHK > 0 THEN 1618 ELSE 1619

1618 N=FGS(1,J,15)+FGS(2,J,15)+FGS(3,J,15)+FGS(4,J,15)+FGS(5,J,15)+FGS(6,J,15)+FGS(7,J,15)+FGS(8,J,15)+FGS(9,J,15)+FGS(10,J,15)+FGS(11,J,15)+FGS(12,J,15)+FGS(13,J,15)+FGS(14,J,15)+FGS(15,J,15):GOTO 1620

1619 N=FGS(1,J,15)+FGS(2,J,15)+FGS(3,J,15)+FGS(4,J,15)+FGS(5,J,15)+FGS(6,J,15)+FGS(7,J,15)+FGS(8,J,15)+FGS(9,J,15)+FGS(10,J,15)+FGS(11,J,15)+FGS(12,J,15)+FGS(13,J,15)+FGS(14,J,15)+FGS(15,J,15)+1
	IF I=0 THEN 1620
	IF I=1 THEN 1630

1620 FOR K = 3 TO 6
	FGS(N,J,K-3)=Z2(K,17):NEXT K
	FGS(N,J,4)=LF(I)
	FGS(N,J,15)=1:FGS(N,J,16)=Y
	FOR J1=0 TO 4:FGS(N,J,J1+5)=AM(I,J1):NEXT
	FOR J1=0 TO 4:FGS(N,J,J1+10)=AF(I,J1):NEXT
	GOTO 1632

1630 FOR K = 7 TO 10
	FGS(N,J,K-7)=Z2(K,17):NEXT K
	FGS(N,J,4)=LF(I)
	FGS(N,J,15)=1:FGS(N,J,16)=Y
	FOR J1=0 TO 4:FGS(N,J,J1+5)=AM(I,J1):NEXT
	FOR J1=0 TO 4:FGS(N,J,J1+10)=AF(I,J1):NEXT

1632 GOTO 1636

1633 RR=RR+1
	IF RR=10 THEN GOSUB 1638
	NEXT J

1636 NEXT I
	GOTO 1660

1638 IF A7$(I)="END" OR A7$(I)="XXX" OR LEFT$(A7$(I),1)=" " THEN 1650 ELSE 1639

1639 NH=NH+1
	A7C$(NH)=A7$(I)
	N=1
	IF I=0 THEN 1642
	IF I=1 THEN 1645

1642 FOR K = 3 TO 6:
	FGS(N,NH,K-3)=Z2(K,17):NEXT K
	FGS(N,NH,4)=LF(I)
	FGS(N,NH,15)=1:FGS(N,NH,16)=Y
	FOR J1=0 TO 4:FGS(N,NH,J1+5)=AM(I,J1):NEXT
	FOR J1=0 TO 4:FGS(N,NH,J1+10)=AF(I,J1):NEXT
	GOTO 1660

1645 FOR K = 7 TO 10:
	FGS(N,NH,K-7)=Z2(K,17):NEXT K
	FGS(N,NH,4)=LF(I)
	FGS(N,NH,15)=1:FGS(N,J,16)=Y
	FOR J1=0 TO 4:FGS(N,NH,J1+5)=AM(I,J1):NEXT
	FOR J1=0 TO 4:FGS(N,NH,J1+10)=AF(I,J1):NEXT

1650 RETURN

1660 FOR I = 0 TO 9
	RR=0:CHK=0
	FOR J = 0 TO 54
	IF DI$(I)=DIC$(J) THEN 1664 ELSE 1673

1664 FOR W= 1 TO 15:IF GIS(W,J,2) = Y THEN 1665 ELSE 1666

1665 CHK=CHK+1

1666 NEXT W
	IF CHK > 0 THEN 1668 ELSE 1669

1668 N=GIS(1,J,1)+GIS(2,J,1)+GIS(3,J,1)+GIS(4,J,1)+GIS(5,J,1)+GIS(6,J,1)+GIS(7,J,1)+GIS(8,J,1)+GIS(9,J,1)+GIS(10,J,1)+GIS(11,J,1)+GIS(12,J,1)+GIS(13,J,1)+GIS(14,J,1)+GIS(15,J,1):GOTO 1670

1669 N=GIS(1,J,1)+GIS(2,J,1)+GIS(3,J,1)+GIS(4,J,1)+GIS(5,J,1)+GIS(6,J,1)+GIS(7,J,1)+GIS(8,J,1)+GIS(9,J,1)+GIS(10,J,1)+GIS(11,J,1)+GIS(12,J,1)+GIS(13,J,1)+GIS(14,J,1)+GIS(15,J,1)+1

1670 GIS(N,J,0)=GI%(I, 0)
	GIS(N,J,1)=1:GIS(N,J,2)=Y
	GOTO 1676

1673 RR=RR+1
	IF RR=10 THEN GOSUB 1678
	NEXT J

1676 NEXT I
	GOTO 1700

1678 IF DI$(I)="END" OR DI$(I)="XXX" OR LEFT$(DI$(I),1)=" " THEN 1684 ELSE 1679

1679 NJ=NJ+1
	DIC$(NJ)=DI$(I)
	N=1
	GIS(N,NJ,0)=GI%(I, 0)
	GIS(N,NJ,1)=1:GIS(N,NJ,2)=Y

1684 RETURN

1700 FOR I = 0 TO 14
	RR=0:CHK=0
	FOR J = 0 TO 54
	IF DS$(I)=DSC$(J) THEN 1704 ELSE 1713

1704 FOR W= 1 TO 15:IF GSS(W,J,2) = Y THEN 1705 ELSE 1706

1705 CHK=CHK+1

1706 NEXT W
	IF CHK > 0 THEN 1708 ELSE 1709

1708 N=GSS(1,J,1)+GSS(2,J,1)+GSS(3,J,1)+GSS(4,J,1)+GSS(5,J,1)+GSS(6,J,1)+GSS(7,J,1)+GSS(8,J,1)+GSS(9,J,1)+GSS(10,J,1)+GSS(11,J,1)+GSS(12,J,1)+GSS(13,J,1)+GSS(14,J,1)+GSS(15,J,1):GOTO 1710

1709 N=GSS(1,J,1)+GSS(2,J,1)+GSS(3,J,1)+GSS(4,J,1)+GSS(5,J,1)+GSS(6,J,1)+GSS(7,J,1)+GSS(8,J,1)+GSS(9,J,1)+GSS(10,J,1)+GSS(11,J,1)+GSS(12,J,1)+GSS(13,J,1)+GSS(14,J,1)+GSS(15,J,1)+1

1710 GSS(N,J,0)=GS%(I, 0)
	GSS(N,J,1)=1:GSS(N,J,2)=Y
	GOTO 1716

1713 RR=RR+1
	IF RR=15 THEN GOSUB 1718
	NEXT J

1716 NEXT I
	GOTO 1800

1718 IF DS$(I)="END" OR DS$(I)="XXX" OR LEFT$(DS$(I),1)=" " THEN 1724 ELSE 1719

1719 NK=NK+1
	DSC$(NK)=DS$(I)
	N=1
	GSS(N,NK,0)=GS%(I, 0)
	GSS(N,NK,1)=1:GSS(N,NK,2)=Y

1724 RETURN

1800 IF JX=1 THEN 1804
	IF JX=0 THEN 1805

1804 GOSUB 2080

1805 GOSUB 1300
OPEN D$(1) + Z$ + ".CAR" FOR OUTPUT AS #1
	WRITE #1, TN$, NB,NC,ND,NE,NF,NG,NH,NI,NJ,NK
	FOR I = 0 TO 49:WRITE #1, A1C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 39:WRITE #1, A2C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 19:WRITE #1, A3C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 14:WRITE #1, A4C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 14:WRITE #1, A5C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 9:WRITE #1, A6C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 9:WRITE #1, A7C$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 54:WRITE #1, DIC$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR I = 0 TO 54:WRITE #1, DSC$(I):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT
	FOR N = 1 TO 15:FOR J = 0 TO 49:FOR K = 0 TO 9:WRITE #1, RBBS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 49:WRITE #1, RBS$(N,J,0),RBS$(N,J,1):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 39:FOR K = 0 TO 5:WRITE #1, WRRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 39:WRITE #1, WRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 19:FOR K = 0 TO 7:WRITE #1, QBBS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 19:WRITE #1, QBS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:FOR K = 0 TO 5:WRITE #1, KRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:WRITE #1, KRRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:FOR K = 0 TO 5:WRITE #1, PRS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 14:WRITE #1, PRRS$(N,J,0):LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 9:FOR K = 0 TO 3:WRITE #1, PUS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 9:FOR K = 0 TO 16:WRITE #1, FGS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 54:FOR K = 0 TO 2:WRITE #1, GIS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
	FOR N = 1 TO 15:FOR J = 0 TO 54:FOR K = 0 TO 2:WRITE #1, GSS(N,J,K):NEXT K:LOCATE 21,38:COLOR 5:TMR=TMR-1:PRINT USING "#####";TMR:NEXT J:NEXT N
CLOSE #1
	CLEAR
	RUN "CAREER1.EXE"

2080 IF NOT _FILEEXISTS(D$(1) + Z$ +".CLD") THEN 2090
OPEN D$(1) + Z$ + ".CLD" FOR INPUT AS #1
	FOR I = 0 TO 9:INPUT #1, RBBC(I), RBC$(I), RBYR(I):NEXT
	INPUT #1, RBR$(0),RBR$(1)
	FOR I = 0 TO 4:INPUT #1, WRRC(I), WRC$(I), WRYR(I):NEXT
	INPUT #1, WRR$
	FOR I = 0 TO 8:INPUT #1, QBBC(I), QBC$(I), QBYR(I):NEXT
	INPUT #1, QBR$
	FOR I = 0 TO 4:INPUT #1, KRRC(I), KRC$(I), KRYR(I):NEXT
	INPUT #1, KRR$
	FOR I = 0 TO 4:INPUT #1, PRRC(I), PRC$(I), PRYR(I):NEXT
	INPUT #1, PRR$
	FOR I = 0 TO 2:INPUT #1, PUUC(I), PUC$(I), PUYR(I):NEXT
	FOR I = 0 TO 6:INPUT #1, FGGC(I), FGC$(I), FGYR(I):NEXT
	FOR I = 0 TO 1:INPUT #1, DFFC(I), DFC$(I), DFYR(I):NEXT
CLOSE #1

2090 FOR I = 0 TO 49
	IF A1C$(I)="" OR A1C$(I)="XXX" OR A1C$(I)="END" THEN 2180
	FOR J = 1 TO 15
	IF RBBS(J,I,8)=0 THEN 2180 ELSE 2103

2103 IF RBBS(J,I,0) > RBBC(0) THEN 2104 ELSE 2113

2104 RBBC(0)=RBBS(J,I,0):RBC$(0)=A1C$(I):RBYR(0)=RBBS(J,I,8)

2113 IF RBBS(J,I,1) > RBBC(1) THEN 2114 ELSE 2123

2114 RBBC(1)=RBBS(J,I,1):RBC$(1)=A1C$(I):RBYR(1)=RBBS(J,I,8)

2123 IF RBBS(J,I,0)=0 THEN 2133
	IF RBBS(J,I,1)/RBBS(J,I,0) <= RBBC(2) OR RBBS(J,I,0)<GAMES*10 THEN 2133

2125 RBBC(2)=RBBS(J,I,1)/RBBS(J,I,0):RBC$(2)=A1C$(I):RBYR(2)=RBBS(J,I,8)

2133 IF RBBS(J,I,2) <= RBBC(3) THEN 2143

2134 RBBC(3)=RBBS(J,I,2):RBC$(3)=A1C$(I):RBYR(3)=RBBS(J,I,8)

2143 IF RBBS(J,I,3) <= RBBC(4) THEN 2153

2144 RBBC(4)=RBBS(J,I,3):RBC$(4)=A1C$(I):RBYR(4)=RBBS(J,I,8)

2153 IF RBBS(J,I,4) <= RBBC(5) THEN 2163

2154 RBBC(5)=RBBS(J,I,4):RBC$(5)=A1C$(I):RBYR(5)=RBBS(J,I,8)

2163 IF RBBS(J,I,3)=0 THEN 2173
	IF RBBS(J,I,4)/RBBS(J,I,3) <= RBBC(6) OR RBBS(J,I,3)<GAMES*3 THEN 2173

2165 RBBC(6)=RBBS(J,I,4)/RBBS(J,I,3):RBC$(6)=A1C$(I):RBYR(6)=RBBS(J,I,8)

2173 IF RBBS(J,I,5) <= RBBC(7) THEN 2175

2174 RBBC(7)=RBBS(J,I,5):RBC$(7)=A1C$(I):RBYR(7)=RBBS(J,I,8)

2175 IF RBBS(J,I,6) <= RBBC(8) THEN 2177

2176 RBBC(8)=RBBS(J,I,6):RBC$(8)=A1C$(I):RBYR(8)=RBBS(J,I,8):RBR$(0)=RBS$(J,I,0)

2177 IF RBBS(J,I,9) <= RBBC(9) THEN 2179

2178 RBBC(9)=RBBS(J,I,9):RBC$(9)=A1C$(I):RBYR(9)=RBBS(J,I,8):RBR$(1)=RBS$(J,I,1)

2179 NEXT J

2180 NEXT I
	FOR I = 0 TO 39
	IF A2C$(I)="" OR A2C$(I)="XXX" OR A2C$(I)="END" THEN 2280
	FOR J = 1 TO 15
	IF WRRS(J,I,5)=0 THEN 2280

2203 IF WRRS(J,I,0) <= WRRC(0) THEN 2213

2204 WRRC(0)=WRRS(J,I,0):WRC$(0)=A2C$(I):WRYR(0)=WRRS(J,I,5)

2213 IF WRRS(J,I,1) <= WRRC(1) THEN 2223

2214 WRRC(1)=WRRS(J,I,1):WRC$(1)=A2C$(I):WRYR(1)=WRRS(J,I,5)

2223 IF WRRS(J,I,0)=0 THEN 2233
	IF WRRS(J,I,1)/WRRS(J,I,0) <= WRRC(2) OR WRRS(J,I,0)<GAMES*3 THEN 2233

2225 WRRC(2)=WRRS(J,I,1)/WRRS(J,I,0):WRC$(2)=A2C$(I):WRYR(2)=WRRS(J,I,5)

2233 IF WRRS(J,I,2) <= WRRC(3) THEN 2235

2234 WRRC(3)=WRRS(J,I,2):WRC$(3)=A2C$(I):WRYR(3)=WRRS(J,I,5)

2235 IF WRRS(J,I,3) <= WRRC(4) THEN 2279

2236 WRRC(4)=WRRS(J,I,3):WRC$(4)=A2C$(I):WRYR(4)=WRRS(J,I,5):WRR$=WRS$(J,I,0)

2279 NEXT J

2280 NEXT I
	FOR I = 0 TO 19
	IF A3C$(I)="" OR A3C$(I)="XXX" OR A3C$(I)="END" THEN 2380
	FOR J = 1 TO 15:GOSUB 8999
	IF QBBS(J,I,7)=0 THEN 2380

2303 IF QBBS(J,I,1) <= QBBC(0) THEN 2313

2304 QBBC(0)=QBBS(J,I,1):QBC$(0)=A3C$(I):QBYR(0)=QBBS(J,I,7)

2313 IF QBBS(J,I,0) <= QBBC(1) THEN 2323

2314 QBBC(1)=QBBS(J,I,0):QBC$(1)=A3C$(I):QBYR(1)=QBBS(J,I,7)

2323 IF QBBS(J,I,2) <= QBBC(2) THEN 2333

2324 QBBC(2)=QBBS(J,I,2):QBC$(2)=A3C$(I):QBYR(2)=QBBS(J,I,7)

2333 IF QBBS(J,I,4) <= QBBC(3) THEN 2343

2334 QBBC(3)=QBBS(J,I,4):QBC$(3)=A3C$(I):QBYR(3)=QBBS(J,I,7)

2343 IF QBBS(J,I,3) <= QBBC(4) THEN 2353

2344 QBBC(4)=QBBS(J,I,3):QBC$(4)=A3C$(I):QBYR(4)=QBBS(J,I,7)

2353 IF QBBS(J,I,0)=0 THEN 2363
	IF QBBS(J,I,1)/QBBS(J,I,0) <= QBBC(5) OR QBBS(J,I,0)<GAMES*15 THEN 2363

2355 QBBC(5)=QBBS(J,I,1)/QBBS(J,I,0):QBC$(5)=A3C$(I):QBYR(5)=QBBS(J,I,7)

2363 IF QBBS(J,I,1)=0 THEN 2373
	IF QBBS(J,I,3)/QBBS(J,I,1) <=QBBC(6) OR QBBS(J,I,0)<GAMES*15 THEN 2373

2365 QBBC(6)=QBBS(J,I,3)/QBBS(J,I,1):QBC$(6)=A3C$(I):QBYR(6)=QBBS(J,I,7)

2373 IF QBBS(J,I,12) <= QBBC(7) THEN 2375

2374 QBBC(7)=QBBS(J,I,12):QBC$(7)=A3C$(I):QBYR(7)=QBBS(J,I,7)

2375 IF QBBS(J,I,5) <= QBBC(8) THEN 2379

2376 QBBC(8)=QBBS(J,I,5):QBC$(8)=A3C$(I):QBYR(8)=QBBS(J,I,7):QBR$=QBS$(J,I,0)

2379 NEXT J

2380 NEXT I
	FOR I = 0 TO 14
	IF A4C$(I)="" OR A4C$(I)="XXX" OR A4C$(I)="END" THEN 2480
	FOR J = 1 TO 15
	IF KRS(J,I,5)=0 THEN 2480

2403 IF KRS(J,I,0) <= KRRC(0) THEN 2413

2404 KRRC(0)=KRS(J,I,0):KRC$(0)=A4C$(I):KRYR(0)=KRS(J,I,5)

2413 IF KRS(J,I,1) <= KRRC(1) THEN 2423

2414 KRRC(1)=KRS(J,I,1):KRC$(1)=A4C$(I):KRYR(1)=KRS(J,I,5)

2423 IF KRS(J,I,0)=0 THEN 2433
	IF KRS(J,I,1)/KRS(J,I,0) <= KRRC(2) OR KRS(J,I,0)<GAMES*1.2 THEN 2433

2425 KRRC(2)=KRS(J,I,1)/KRS(J,I,0):KRC$(2)=A4C$(I):KRYR(2)=KRS(J,I,5)

2433 IF KRS(J,I,2) <= KRRC(3) THEN 2435

2434 KRRC(3)=KRS(J,I,2):KRC$(3)=A4C$(I):KRYR(3)=KRS(J,I,5)

2435 IF KRS(J,I,3) <= KRRC(4) THEN 2479

2436 KRRC(4)=KRS(J,I,3):KRC$(4)=A4C$(I):KRYR(4)=KRS(J,I,5):KRR$=KRRS$(J,I,0)

2479 NEXT J

2480 NEXT I
	FOR I = 0 TO 14
	IF A5C$(I)="" OR A5C$(I)="XXX" OR A5C$(I)="END" THEN 2580
	FOR J = 1 TO 15
	IF PRS(J,I,5)=0 THEN 2580

2503 IF PRS(J,I,0) > PRRC(0) THEN 2504 ELSE 2513

2504 PRRC(0)=PRS(J,I,0):PRC$(0)=A5C$(I):PRYR(0)=PRS(J,I,5)

2513 IF PRS(J,I,1) <= PRRC(1) THEN 2523

2514 PRRC(1)=PRS(J,I,1):PRC$(1)=A5C$(I):PRYR(1)=PRS(J,I,5)

2523 IF PRS(J,I,0)=0 THEN 2533
	IF PRS(J,I,1)/PRS(J,I,0) <= PRRC(2) OR PRS(J,I,0)<GAMES*1.2 THEN 2533

2525 PRRC(2)=PRS(J,I,1)/PRS(J,I,0):PRC$(2)=A5C$(I):PRYR(2)=PRS(J,I,5)

2533 IF PRS(J,I,2) <= PRRC(3) THEN 2535

2534 PRRC(3)=PRS(J,I,2):PRC$(3)=A5C$(I):PRYR(3)=PRS(J,I,5)

2535 IF PRS(J,I,3) <= PRRC(4) THEN 2579

2536 PRRC(4)=PRS(J,I,3):PRC$(4)=A5C$(I):PRYR(4)=PRS(J,I,5):PRR$=PRRS$(J,I,0)

2579 NEXT J

2580 NEXT I
	FOR I = 0 TO 9
	IF A6C$(I)="" OR A6C$(I)="XXX" OR A6C$(I)="END" THEN 2680
	FOR J = 1 TO 15
	IF PUS(J,I,3)=0 THEN 2680 ELSE 2603

2603 IF PUS(J,I,0) <= PUUC(0) THEN 2613

2604 PUUC(0)=PUS(J,I,0):PUC$(0)=A6C$(I):PUYR(0)=PUS(J,I,3)

2613 IF PUS(J,I,1) <= PUUC(1) THEN 2623

2614 PUUC(1)=PUS(J,I,1):PUC$(1)=A6C$(I):PUYR(1)=PUS(J,I,3)

2623 IF PUS(J,I,0)=0 THEN 2679
	IF PUS(J,I,1)/PUS(J,I,0) <= PUUC(2) THEN 2679

2625 PUUC(2)=PUS(J,I,1)/PUS(J,I,0):PUC$(2)=A6C$(I):PUYR(2)=PUS(J,I,3)

2679 NEXT J

2680 NEXT I
	FOR I=0 TO 9
	IF A7C$(I)="" OR A7C$(I)="XXX" OR A7C$(I)="END" THEN 2780
	FOR J=1 TO 15
	IF FGS(J,I,16)=0 THEN 2780
	IF FGS(J,I,1)<=FGGC(0) THEN 2713
	FGGC(0)=FGS(J,I,1):FGC$(0)=A7C$(I):FGYR(0)=FGS(J,I,16)

2713 IF FGS(J,I,0)<=FGGC(1) THEN 2723
	FGGC(1)=FGS(J,I,0):FGC$(1)=A7C$(I):FGYR(1)=FGS(J,I,16)

2723 IF FGS(J,I,1)=0 THEN 2733
	IF FGS(J,I,0)/FGS(J,I,1) <= FGGC(2) OR FGS(J,I,1)<GAMES THEN 2733

2725 FGGC(2)=FGS(J,I,0)/FGS(J,I,1):FGC$(2)=A7C$(I):FGYR(2)=FGS(J,I,16)

2733 IF FGS(J,I,3) <= FGGC(3) THEN 2743

2734 FGGC(3)=FGS(J,I,3):FGC$(3)=A7C$(I):FGYR(3)=FGS(J,I,16)

2743 IF FGS(J,I,2) <= FGGC(4) THEN 2753

2744 FGGC(4)=FGS(J,I,2):FGC$(4)=A7C$(I):FGYR(4)=FGS(J,I,16)

2753 IF FGS(J,I,2)=0 THEN 2756
	IF FGS(J,I,2)/FGS(J,I,3) <= FGGC(5) OR FGS(J,I,3)<GAMES THEN 2756

2755 FGGC(5)=FGS(J,I,2)/FGS(J,I,3):FGC$(5)=A7C$(I):FGYR(5)=FGS(J,I,16)

2756 IF FGS(J,I,4) <= FGGC(6) THEN 2779

2757 FGGC(6)=FGS(J,I,4):FGC$(6)=A7C$(I):FGYR(6)=FGS(J,I,16)

2779 NEXT J

2780 NEXT I
	FOR I = 0 TO 54
	IF DIC$(I)="" OR DIC$(I)="XXX" OR DIC$(I)="END" THEN 2810
	FOR J = 1 TO 15
	IF GIS(J,I,2)=0 THEN 2810

2803 IF GIS(J,I,0) <= DFFC(0) THEN 2809

2804 DFFC(0)=GIS(J,I,0):DFC$(0)=DIC$(I):FGYR(0)=GIS(J,I,2)

2809 NEXT J

2810 NEXT I
	FOR I = 0 TO 54
	IF DSC$(I)="" OR DSC$(I)="XXX" OR DSC$(I)="END" THEN 2830
	FOR J = 1 TO 15
	IF GSS(J,I,2)=0 THEN 2830

2823 IF GSS(J,I,0) <= DFFC(1) THEN 2829

2824 DFFC(1)=GSS(J,I,0):DFC$(1)=DSC$(I):FGYR(1)=GSS(J,I,2)

2829 NEXT J

2830 NEXT I
OPEN D$(1) + Z$ + ".CLD" FOR OUTPUT AS #1
	FOR I = 0 TO 9:WRITE #1, RBBC(I), RBC$(I), RBYR(I):NEXT
	WRITE #1, RBR$(0),RBR$(1)
	FOR I = 0 TO 4:WRITE #1, WRRC(I), WRC$(I), WRYR(I):NEXT
	WRITE #1, WRR$
	FOR I = 0 TO 8:WRITE #1, QBBC(I), QBC$(I), QBYR(I):NEXT
	WRITE #1, QBR$
	FOR I = 0 TO 4:WRITE #1, KRRC(I), KRC$(I), KRYR(I):NEXT
	WRITE #1, KRR$
	FOR I = 0 TO 4:WRITE #1, PRRC(I), PRC$(I), PRYR(I):NEXT
	WRITE #1, PRR$
	FOR I = 0 TO 2:WRITE #1, PUUC(I), PUC$(I), PUYR(I):NEXT
	FOR I = 0 TO 6:WRITE #1, FGGC(I), FGC$(I), FGYR(I):NEXT
	FOR I = 0 TO 1:WRITE #1, DFFC(I), DFC$(I), DFYR(I):NEXT
CLOSE #1
	RETURN

8999 IF QBBS(J,I,0)>0 THEN QBBS(J,I,11)=INT(QBBS(J,I,1)/QBBS(J,I,0)*1000)/10
	IF QBBS(J,I,0)=0 THEN QBBS(J,I,11)=0:QBBS(J,I,8)=0:QBBS(J,I,10)=0:QBBS(J,I,9)=0:GOTO 9005
	QBBS(J,I,8)=INT(QBBS(J,I,5)/QBBS(J,I,0)*1000)/10
	QBBS(J,I,10)=INT(QBBS(J,I,4)/QBBS(J,I,0)*100)/100
	QBBS(J,I,9)=INT(QBBS(J,I,3)/QBBS(J,I,0)*1000)/10

9005 PP(J,I)=QBBS(J,I,11)-30
	IF PP(J,I)<0 THEN PP(J,I)=0:GOTO 9009
	IF PP(J,I)>77.5 THEN PP(J,I)=2.375:GOTO 9009
	PP(J,I)=PP(J,I)*.05

9009 IF QBBS(J,I,8)>11.9 THEN FF(J,I)=2.375:GOTO 9011
	FF(J,I)=QBBS(J,I,8)*.2

9011 IF QBBS(J,I,9)=0 THEN II(J,I)=0:GOTO 9014
	IF QBBS(J,I,9)>9.5 THEN II(J,I)=0:GOTO 9014
	II(J,I)=2.375-(.25*QBBS(J,I,9))

9014 QBBS(J,I,10)=QBBS(J,I,10)-3
	IF QBBS(J,I,10)<0 THEN YY(J,I)=0:GOTO 9020
	IF QBBS(J,I,10)>12.5 THEN YY(J,I)=2.375:GOTO 9020
	D=INT(QBBS(J,I,10)*100)/2
	IF D=QBBS(J,I,10)/2 THEN YY(J,I)=QBBS(J,I,10)/2*.3+QBBS(J,I,10)/2*.2:GOTO 9020
	YY(J,I)=QBBS(J,I,10)/2*.3+QBBS(J,I,10)/2*.2+.003

9020 QBBS(J,I,12)=PP(J,I)+FF(J,I)+II(J,I)+YY(J,I)
	IF QBBS(J,I,12)>9.5 THEN QBBS(J,I,12)=158.3:GOTO 9027
	QBBS(J,I,12)=QBBS(J,I,12)*50/3

9027 QBBS(J,I,12)=INT(QBBS(J,I,12)*10)/10
	RETURN

3056 COLOR 15, 0: CLS
	JJ = 6
	SN = 1: LOCATE 6, 8: COLOR 15, 4
	PRINT " Ö"; STRING$(61, 196); "· "; : FOR II = 1 TO JJ: LOCATE 6 + II, 8
	PRINT " º"; STRING$(61, 32); "º "; : NEXT
	LOCATE 7 + JJ, 8
	PRINT " Ó"; STRING$(61, 196); "½ "; : LOCATE 7, 32
	LOCATE , 12: PRINT "ENTER DISK ID: ": PRINT
	LOCATE , 12: PRINT "THE DISK ID IS USUALLY THE LAST TWO DIGITS OF THE"
	LOCATE , 12: PRINT "SEASON DISK YOU ARE PLAYING FROM (IE. 89, 76, 67)."
	LOCATE , 12: PRINT "THIS IS THE ID FOR TEAM YOU ARE UPDATING"
	PRINT
	LOCATE , 12: PRINT "ESC TO RETURN TO MAIN MENU"
3057 I$ = GetKeyPress$
	IF I$ = CHR$(27) THEN Z$ = "END": CLEAR:GOTO 1
	IF I$ = CHR$(13) THEN GOSUB 1102: GOTO 3060

	LOCATE 7, 27: PRINT I$
	LOCATE 7, 28: LINE INPUT NY$
	NY$ = I$ + NY$
	COLOR 15, 0
	IF NY$ = "" THEN GOSUB 1102: GOTO 3060
	YN$ = NY$
	FOR I = 1 TO 500: VV$(I) = "": NEXT
	GOSUB 1100

3060 IF BO% = 1 THEN BO% = 0: GOTO 3056

3058 LOCATE 2, 33: COLOR PA%(2), PA%(1)
	PRINT A$
	COLOR 15, 4: LOCATE , 33: PRINT "ANY CHANGE (YN)";
	I$=GetKeyPress$
	IF UCASE$(I$) = "Y" THEN 3056
	COLOR 15, 0
	RETURN

1100 NTMS = 0
OPEN D$(0) + "FOOT." + YN$ FOR RANDOM AS #1 LEN = 934
	Y = LOF(1)
	FIELD #1, 15 AS Q$(0), 640 AS X$
	FOR I1 = 1 TO Y / 934
	GET #1, I1
	FOR I2 = 1 TO 15
	IF ASC(MID$(Q$(0), I2, 1)) < 32 OR ASC(MID$(Q$(0), I2, 1)) > 123 OR UCASE$(LEFT$(Q$(0), 3)) = "NOT" OR UCASE$(LEFT$(Q$(0), 3)) = "UN" THEN 1105
	NEXT I2
	NTMS = NTMS + 1
	VV$(NTMS) = Q$(0): V%(NTMS) = I1

1105 NEXT I1
CLOSE 1

1102 SELECTION% = 1
	Count% = NTMS
	Start% = 1
	FileFGColr% = 15:FileBGColr% = 4
	HiLiteFGColr% = 0:HiLiteBGColr% = 7
	Rows% = 20
	Columns% = 4
	Spacing% = 6
	Row% = 4
	Column% = 1
	COLOR , 4: CLS : LOCATE , 33: COLOR 14
	PRINT "TEAM SELECTION": COLOR 15
	LOCATE 25, 1: COLOR 14: PRINT "ESC"; : COLOR 15
	PRINT "-SELECT NEW ID  PGDN  PGUP  "; : COLOR 14
	PRINT "ENTER"; : COLOR 15: PRINT "-SELECTS TEAM";
	
_MouseShow "DEFAULT"
21   MAMenu VARPTR(VV$(1)), SELECTION%, Start%, Count%, EXITCODE%, FileFGColr%, FileBGColr%, HiLiteFGColr%, HiLiteBGColr%, Rows%, Columns%, Spacing%, Row%, Column%
_MouseHide

	IF EXITCODE% = 27 THEN BO% = 1: RETURN
	IF EXITCODE% = -71 THEN Start% = 1: EXITCODE% = 3: SELECTION% = 1: GOTO 21
	IF EXITCODE% = -79 THEN Start% = NTMS: EXITCODE% = 3: SELECTION% = NTMS: GOTO 21
	IF EXITCODE% = -73 THEN Start% = Start% - 80: IF Start% < 1 THEN Start% = 1
	IF EXITCODE% = -81 THEN Start% = Start% + 80: IF Start% > NTMS THEN Start% = NTMS
	IF EXITCODE% = -81 OR EXITCODE% = -73 THEN EXITCODE% = 3: SELECTION% = Start%: GOTO 21
	T1 = V%(SELECTION%)
OPEN D$(0) + "FOOT." + YN$ FOR RANDOM AS #1 LEN = 934
	FIELD #1, 15 AS Q$(1), 15 AS Q$(2), 2 AS Q$(3), 2 AS Q$(4), 2 AS Q$(5), 2 AS Q$(6), 2 AS Q$(7), 2 AS Q$(8), 2 AS Q$(9), 2 AS Q$(10), 2 AS Q$(11), 2 AS Q$(12), 2 AS Q$(13), 2 AS Q$(14), 2 AS Q$(15), 200 AS Q$(0), 200 AS Q$(199), 200 AS Q$, 200  _
AS Q$, 78 AS Q$(0)
	GET #1, T1
	A$ = Q$(1)
	FOR I1 = 0 TO 4: PA%(I1) = CVI(Q$(I1 + 11)): NEXT I1
CLOSE 1

9006 IF RIGHT$(A$, 1) = " " THEN A$ = LEFT$(A$, LEN(A$) - 1): GOTO 9006
	RETURN

6585 FOR XX = 4 TO 11: IF MID$(B$, XX, 1) = " " OR MID$(B$, XX, 1) = "." THEN MID$(B$, XX, 1) = "_"
	NEXT XX
	FOR XX = 12 TO 14: IF MID$(B$, XX, 2) = "ST" THEN MID$(B$, 9, 1) = "_": MID$(B$, 10, 2) = "ST"
	NEXT XX
	QQ = 8: FOR XX = 11 TO 4 STEP -1: IF MID$(B$, XX, 1) = "_" THEN QQ = XX - 4: GOTO 6615
	GOTO 6620

6615 NEXT XX

6620 RETURN

4000 Spec$ = D$(1) + "*.CAR"
	COUNT% = FCount%(Spec$)
	IF COUNT% = 0 THEN 4500
REDIM F$(0 TO COUNT%)
	FOR X = 1 TO COUNT%
	  F$(X) = SPACE$(12)
	NEXT
	F$(0) = Spec$
	CALL ReadFile(F$())
	'CALL SortStr(VARPTR(F$(1)), COUNT%, 0)

1310 CLS
	COLOR , 1
	CLS
	LOCATE , 28
	COLOR 14
	PRINT "SELECT FILE TO UPDATE": COLOR 15
	SELECTION% = 1
	START% = 1
	FileFGColr% = 15:FileBGColr% = 1
	HiLiteFGColr% = 0:HiLiteBGColr% = 7
	Rows% = 20
	Columns% = 4
	Spacing% = 6
	Row% = 4
	Column% = 1
	LOCATE 25, 1
	COLOR 14
	PRINT "ENTER"; : COLOR 15
	PRINT "-SELECTS TEAM LIBRARY";

_MouseShow "DEFAULT"
20 MAMenu F$(), SELECTION%, START%, COUNT%, EXITCODE%, FileFGColr%, FileBGColr%, HiLiteFGColr%, HiLiteBGColr%, Rows%, Columns%, Spacing%, Row%, Column%
_MouseHide

	IF EXITCODE% = 27 THEN 1
	IF EXITCODE% = -71 THEN START% = 1: EXITCODE% = 3: SELECTION% = 1: GOTO 20
	IF EXITCODE% = -79 THEN START% = COUNT%: EXITCODE% = 3: SELECTION% = COUNT%: GOTO 20
	IF EXITCODE% = -73 THEN START% = START% - 80: IF START% < 1 THEN START% = 1
	IF EXITCODE% = -81 THEN START% = START% + 80: IF START% > COUNT% THEN START% = COUNT%
	IF EXITCODE% = -81 OR EXITCODE% = -73 THEN EXITCODE% = 3: SELECTION% = START%: GOTO 20
	F$ = F$(SELECTION%)
	LOCATE 2, 33: PRINT F$
	LOCATE , 33: PRINT "ANY CHANGE (YN)";
	COLOR 15, 0
3910 I$ = GetKeyPress$
	IF UCASE$(I$) = "Y" THEN 1310

3911 F$ = RTrim$(F$)
	Z$ = LEFT$(F$, LEN(F$) - 4)
	RETURN

4500 GOSUB 4600
	LOCATE, 10:PRINT "NO CAREER FILES WERE FOUND"
	LOCATE ,10:PRINT "PRESS ANY KEY TO RETURN TO MAIN MENU"
3805 I$ = GetKeyPress$
	CLEAR
	GOTO 1

4600 JJ = 4
	LOCATE 6, 8: COLOR 15, 1
	PRINT " "; CHR$(201); STRING$(61, 205); CHR$(187); " ";
	FOR II = 1 TO JJ: LOCATE 6 + II, 8
	PRINT " º"; STRING$(61, 32); "º "; : NEXT
	LOCATE 7 + JJ, 8
	PRINT " "; CHR$(200); STRING$(61, 205); CHR$(188); " "; : LOCATE 7
	RETURN

'$INCLUDE: 'KeyInput.BM'
'$INCLUDE: 'QPProEqu.BM'
